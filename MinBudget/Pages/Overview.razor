@page "/Overview"
@inject BudgetManager BudgetManager

<h3>Översikt inkomster</h3>
@if (BudgetManager.Incomes.Count == 0)
{
    <p>Inga inkomster registrerade.</p>
}
else
{
    <table style="width: 100%; max-width: 500px; margin-top: 12px; border-collapse: collapse;">
        <thead>
            <tr style="background: #e0f7fa;">
                <th style="text-align: right; padding: 8px;">Belopp</th>
                <th style="padding: 8px;">Ta bort</th>
            </tr>
        </thead>
        <tbody>
            @for (int i = 0; i < BudgetManager.Incomes.Count; i++)
            {
                var income = BudgetManager.Incomes[i];
                <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 8px; text-align: right;">@income.Amount kr</td>
                    <td style="padding: 8px; text-align: center;">
                        <button @onclick="async () => await RemoveIncome(i)" style="background: #ccefff; border: none; border-radius: 4px; padding: 4px 10px; cursor: pointer;">Ta bort</button>
                    </td>
                </tr>
            }
        </tbody>
    </table>
}

<h3 style="margin-top: 32px;">Översikt utgifter</h3>
@if (BudgetManager.Expenses.Count == 0)
{
    <p>Inga utgifter registrerade.</p>
}
else
{
    <table style="width: 100%; max-width: 500px; margin-top: 12px; border-collapse: collapse;">
        <thead>
            <tr style="background: #f0f0f0;">
                <th style="text-align: left; padding: 8px;">Kategori</th>
                <th style="text-align: right; padding: 8px;">Belopp</th>
                <th style="padding: 8px;">Ta bort</th>
            </tr>
        </thead>
        <tbody>
            @for (int i = 0; i < BudgetManager.Expenses.Count; i++)
            {
                var expense = BudgetManager.Expenses[i];
                <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 8px;">@expense.Category</td>
                    <td style="padding: 8px; text-align: right;">@expense.Amount kr</td>
                    <td style="padding: 8px; text-align: center;">
                        <button @onclick="async () => await RemoveExpense(i)" style="background: #ffcccc; border: none; border-radius: 4px; padding: 4px 10px; cursor: pointer;">Ta bort</button>
                    </td>
                </tr>
            }
        </tbody>
    </table>
}

@code {
    protected override async Task OnInitializedAsync()
    {
        await BudgetManager.LoadAsync(); // Laddar data vid sidstart
    }

    // Ta bort inkomst
    private async Task RemoveIncome(int index)
    {
        await BudgetManager.RemoveIncomeAsync(index);
        await BudgetManager.LoadAsync();
        StateHasChanged();
    }

    // Ta bort utgift
    private async Task RemoveExpense(int index)
    {
        await BudgetManager.RemoveExpenseAsync(index);
        await BudgetManager.LoadAsync();
        StateHasChanged();
    }
}
